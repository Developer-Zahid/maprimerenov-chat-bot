<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Maprimerenov Chat Bot</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="./assets/css/style.min.css">
</head>
<body>
    <div class="chat">
        <div class="chat__body">
            <div class="chat__card chat__card--agent">
                <div class="chat__message-wrapper" style="--index: 0">
                    <div class="chat__message">Bonjour, je suis Valentin.</div>
                </div>
                <div class="chat__message-wrapper" style="--index: 1">
                    <div class="chat__message">T√©l√©chargez <strong>gratuitement</strong> notre guide sur les <strong>pompes √† chaleur</strong> pour comprendre leur <strong>fonctionnement</strong>, leur <strong>installation</strong>, leurs <strong>avantages environnementaux</strong> et <strong>√©conomiques</strong>. Que vous envisagiez d'installer une pompe √† chaleur ou simplement curieux, notre guide <strong>est un excellent point de d√©part</strong> pour prendre une d√©cision √©clair√©e.</div>
                </div>
                <div class="chat__message-wrapper" style="--index: 2">
                    <label class="option-btn" role="button">
                        <input class="option-btn__input" type="radio" name="option_1" value="e-book-download" data-toggle="message" data-option="start_step">
                        <span class="option-btn__text">T√©l√©charger le e-book</span>
                    </label>
                </div>
            </div>
        </div>
    </div>

    <script src="https://code.jquery.com/jquery-3.6.4.min.js" integrity="sha256-oP6HI9z1XaZNBrJURtCoUT5SUnxFr8s3BzRl+cbzUq8=" crossorigin="anonymous"></script>
    <script>
        $(document).ready(function () {
            $(".option-btn__input").each(function(index, item){
                item.checked = false;
            });

            var allOptionTemplate = {
                start_step : `
                    <div class="chat__card chat__card--client">
                        <div class="chat__message-wrapper" style="--index: 0">
                            <div class="chat__message">T√©l√©charger le e-book</div>
                        </div>
                    </div>
                    <div class="chat__card chat__card--agent">
                        <div class="chat__message-wrapper" style="--index: 1">
                            <div class="chat__message">
                                Il vous fournira des informations pr√©cieuses, telles que
                                <ul>
                                    <li>Des conseils sur la <strong>taille</strong> et le <strong>dimensionnement</strong> de la pompe √† chaleur recommand√©e.</li>
                                    <li>Les <strong>marques</strong> et les <strong>mod√®les</strong> adapt√©s √† votre logement.</li>
                                    <li>Les √©conomies estim√©es que vous pouvez r√©aliser avec une pompe √† chaleur.</li>
                                    <li>Les prix de vente conseill√©s pour les pompes √† chaleur.</li>
                                    <li>Les subventions disponibles pour l'achat d'une pompe √† chaleur.</li>
                                    <li>Les d√©marches administratives d√©taill√©es pour l'installation de votre pompe √† chaleur.</li>
                                </ul>
                            </div>
                        </div>
                        <div class="chat__message-wrapper" style="--index: 2">
                            <div class="chat__message">Pour cr√©er un guide personnalis√© et adapt√© √† votre logement, nous aurions besoin de quelques informations sur votre situation actuelle.</div>
                        </div>
                        <div class="chat__message-wrapper" style="--index: 3">
                            <div class="chat__message">Avec ces informations, nous pouvons cr√©er un guide personnalis√© qui r√©pondra √† vos besoins sp√©cifiques en mati√®re de pompe √† chaleur. Ces informations ne seront utilis√©es que pour vous aider √† choisir la meilleure option pour votre maison et ne seront jamais partag√©es avec des tiers.</div>
                        </div>
                        <div class="chat__message-wrapper" style="--index: 4">
                            <div class="chat__message">Pour commencer, pouvez-vous me donner la superficie de votre habitation ?</div>
                        </div>
                        <div class="chat__message-wrapper" style="--index: 5">
                            <div class="option-btn-label">Choisissez une option</div>
                            <label class="option-btn" role="button">
                                <input class="option-btn__input" type="radio" name="home_size" value="Inf√©rieur √† 100 m2" data-toggle="message" data-option="home_size__less_than__100">
                                <span class="option-btn__text">Inf√©rieur √† 100 m2</span>
                            </label>
                            <label class="option-btn" role="button">
                                <input class="option-btn__input" type="radio" name="home_size" value="Entre 100 - 150 m2" data-toggle="message" data-option="home_size__between__100_to_150">
                                <span class="option-btn__text">Entre 100 - 150 m2</span>
                            </label>
                            <label class="option-btn" role="button">
                                <input class="option-btn__input" type="radio" name="home_size" value="Sup√©rieur √† 150 m2" data-toggle="message" data-option="home_size__greater_than__150">
                                <span class="option-btn__text">Sup√©rieur √† 150 m2</span>
                            </label>
                        </div>
                    </div>`,
                home_size__less_than__100 : `
                    <div class="chat__card chat__card--client">
                        <div class="chat__message-wrapper" style="--index: 0">
                            <div class="chat__message">Inf√©rieur √† 100 m2</div>
                        </div>
                    </div>
                    <div class="chat__card chat__card--agent">
                        <div class="chat__message-wrapper" style="--index: 1">
                            <div class="chat__message"><strong>Tr√®s bien.</strong></div>
                        </div>
                        <div class="chat__message-wrapper" style="--index: 2">
                            <div class="chat__message">Pouvez-vous me pr√©ciser de <strong>quel genre de propri√©t√©</strong>il s'agit ?</div>
                        </div>
                        <div class="chat__message-wrapper" style="--index: 3">
                            <div class="option-btn-label">Choisissez une option</div>
                            <label class="option-btn option-btn--icon" role="button">
                                <input class="option-btn__input" type="radio" name="property_type" value="Maison" data-toggle="message" data-option="property_type__home">
                                <span class="option-btn__text"><span class="option-btn__text__icon">üè†</span>Maison</span>
                            </label>
                            <label class="option-btn option-btn--icon" role="button">
                                <input class="option-btn__input" type="radio" name="property_type" value="Appartement" data-toggle="message" data-option="property_type__apartment">
                                <span class="option-btn__text"><span class="option-btn__text__icon">üè¢</span>Appartement</span>
                            </label>
                        </div>
                    </div>`,
                property_type__home : `
                    <div class="chat__card chat__card--client">
                        <div class="chat__message-wrapper" style="--index: 0">
                            <div class="chat__message">Maison</div>
                        </div>
                    </div>
                    <div class="chat__card chat__card--agent">
                        <div class="chat__message-wrapper" style="--index: 1">
                            <div class="chat__message">Maison... <strong>D'accord !</strong></div>
                        </div>
                        <div class="chat__message-wrapper" style="--index: 2">
                            <div class="chat__message">Pouvez-vous me dire quel est le <strong>syst√®me de chauffage</strong>que vous utilisez actuellement ? (si vous utilisez un autre moyen de chauffage r√©pondez : √âl√©ctricit√©)</div>
                        </div>
                        <div class="chat__message-wrapper" style="--index: 3">
                            <div class="option-btn-label">Choisissez une option</div>
                            <label class="option-btn option-btn--icon" role="button">
                                <input class="option-btn__input" type="radio" name="current_heating_system" value="Gaz" data-toggle="message" data-option="current_heating_system__gas">
                                <span class="option-btn__text"><span class="option-btn__text__icon">üî•</span>Gaz</span>
                            </label>
                            <label class="option-btn option-btn--icon" role="button">
                                <input class="option-btn__input" type="radio" name="current_heating_system" value="Fioul" data-toggle="message" data-option="current_heating_system__fuel_oil">
                                <span class="option-btn__text"><span class="option-btn__text__icon">üõ¢Ô∏è</span>Fioul</span>
                            </label>
                            <label class="option-btn option-btn--icon" role="button">
                                <input class="option-btn__input" type="radio" name="current_heating_system" value="√âl√©ctricit√©" data-toggle="message" data-option="current_heating_system__electricity">
                                <span class="option-btn__text"><span class="option-btn__text__icon">üîå</span>√âl√©ctricit√©</span>
                            </label>
                        </div>
                    </div>`,
                current_heating_system__gas : `
                    <div class="chat__card chat__card--client">
                        <div class="chat__message-wrapper" style="--index: 0">
                            <div class="chat__message">Gaz</div>
                        </div>
                    </div>
                    <div class="chat__card chat__card--agent">
                        <div class="chat__message-wrapper" style="--index: 1">
                            <div class="chat__message">Pouvez-vous me dire quelle est votre <strong>consommation en √©nergie</strong> pour le chauffage sur <strong>une ann√©e</strong> ?</div>
                        </div>
                        <div class="chat__message-wrapper" style="--index: 2">
                            <div class="option-btn-label">Choisissez une option</div>
                            <label class="option-btn" role="button">
                                <input class="option-btn__input" type="radio" name="energy_consumption_yearly" value="Gaz" data-toggle="message" data-option="energy_consumption_yearly__less_than__1000">
                                <span class="option-btn__text">Inf√©rieur √† 1000‚Ç¨/an</span>
                            </label>
                            <label class="option-btn" role="button">
                                <input class="option-btn__input" type="radio" name="energy_consumption_yearly" value="Gaz" data-toggle="message" data-option="energy_consumption_yearly__between__1000_to_1800">
                                <span class="option-btn__text">Entre 1000‚Ç¨-1800‚Ç¨/an</span>
                            </label>
                            <label class="option-btn" role="button">
                                <input class="option-btn__input" type="radio" name="energy_consumption_yearly" value="Gaz" data-toggle="message" data-option="energy_consumption_yearly__greater_than__1800">
                                <span class="option-btn__text">Sup√©rieur √† 1800‚Ç¨/an</span>
                            </label>
                            <label class="option-btn" role="button">
                                <input class="option-btn__input" type="radio" name="energy_consumption_yearly" value="Gaz" data-toggle="message" data-option="energy_consumption_yearly__skip">
                                <span class="option-btn__text">Je ne sais pas</span>
                            </label>
                        </div>
                    </div>`,
                energy_consumption_yearly__less_than__1000 : `
                    <div class="chat__card chat__card--client">
                        <div class="chat__message-wrapper" style="--index: 0">
                            <div class="chat__message">Inf√©rieur √† 1000‚Ç¨/an</div>
                        </div>
                    </div>
                    <div class="chat__card chat__card--agent">
                        <div class="chat__message-wrapper" style="--index: 1">
                            <div class="chat__message">Selon notre enqu√™te, <strong>91%</strong> des personnes ayant b√©n√©fici√© de cet e-book ont choisi de le partager avec un professionnel RGE pour pouvoir <strong>prendre une d√©cision √©clair√©e</strong>.</div>
                        </div>
                        <div class="chat__message-wrapper" style="--index: 2">
                            <div class="chat__message">
                                J'analyse les informations fournies et met en place votre <strong class="text-success">votre e-book</strong>
                                <div class="progress-bar"></div>
                            </div>
                        </div>
                        <div class="chat__message-wrapper" style="--index: 3">
                            <div class="chat__message flex-grow-1">
                                Pouvez-vous m'indiquer le num√©ro de votre
                                <strong class="d-block">d√©partement ?</strong>
                                <form action="javascript:void()" class="form" data-toggle="form" data-option="department_number_step">
                                    <label class="form-lable">D√©partement</label>
                                    <input type="number" class="form-control" name="department_number" placeholder="Exemple: 02, 51, 93..." min="0" required>
                                    <div class="form-error">
                                        <small class="form-error__before">Votre d√©partement est imp√©ratif afin de vous fournir les subventions disponible de votre r√©gion.</small>
                                        <small class="form-error__after">Entrez votre d√©partement</small>
                                    </div>
                                    <div class="text-right">
                                        <button type="submit" class="form-btn">Recevoir mon e-book (1/3)</button>
                                    </div>
                                </form>
                            </div>
                        </div>
                    </div>`,
                department_number_step : `
                    <div class="chat__card chat__card--agent">
                        <div class="chat__message-wrapper" style="--index: 0">
                            <div class="chat__message">Pouvez-vous m'indiquer le num√©ro de votre <strong>d√©partement ?</strong></div>
                        </div>
                    </div>
                    <div class="chat__card chat__card--client">
                        <div class="chat__message-wrapper" style="--index: 1">
                            <div class="chat__message"><strong>D√©partement: </strong><span data-input-value="department_number"></span></div>
                        </div>
                    </div>
                    <div class="chat__card chat__card--agent">
                        <div class="chat__message-wrapper" style="--index: 2">
                            <div class="chat__message flex-grow-1">
                                Pouvez-vous me donner votre <strong>nom</strong> et <strong>pr√©nom</strong> s'il vous pla√Æt ?
                                <form action="javascript:void()" class="form" data-toggle="form" data-option="department_names_step">
                                    <div class="form-row">
                                        <div class="form-col">
                                            <label class="form-lable">Pr√©nom*</label>
                                            <input type="name" class="form-control" name="first_name" placeholder=" " required>
                                            <div class="form-error">
                                                <small class="form-error__before">Vos donn√©es personnelles sont prot√©g√©es par les lois RGPD</small>
                                                <small class="form-error__after">Champs requis</small>
                                            </div>
                                        </div>
                                        <div class="form-col">
                                            <label class="form-lable">Nom*</label>
                                            <input type="name" class="form-control" name="last_name" placeholder=" " required>
                                            <div class="form-error">
                                                <small class="form-error__after">Champs requis</small>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="text-right">
                                        <button type="submit" class="form-btn">Recevoir mon e-book (2/3)</button>
                                    </div>
                                </form>
                            </div>
                        </div>
                    </div>`,
                department_names_step : `
                    <div class="chat__card chat__card--agent">
                        <div class="chat__message-wrapper" style="--index: 0">
                            <div class="chat__message">Pouvez-vous me donner votre <strong>nom</strong> et <strong>pr√©nom</strong> s'il vous pla√Æt ?</div>
                        </div>
                    </div>
                    <div class="chat__card chat__card--client">
                        <div class="chat__message-wrapper" style="--index: 1">
                            <div class="chat__message">
                                <div><strong>Pr√©nom: </strong><span data-input-value="first_name"></span></div>
                                <div><strong>Nom: </strong><span data-input-value="last_name"></span></div>
                            </div>
                        </div>
                    </div>
                    <div class="chat__card chat__card--agent">
                        <div class="chat__message-wrapper" style="--index: 2">
                            <div class="chat__message">
                                <div>Madame, Monsieur Ditio</div>
                                <div>Votre e-book est maintenant disponible et est constamment actualis√© via Internet en ce qui concerne les subventions disponibles ainsi que les prix actuels du march√©.</div>
                            </div>
                        </div>
                        <div class="chat__message-wrapper" style="--index: 3">
                            <div class="chat__message">
                                Je finalise actuellement les derniers d√©tails de votre <strong class="text-success">e-book</strong>
                                <div class="progress-bar"></div>
                            </div>
                        </div>
                        <div class="chat__message-wrapper" style="--index: 4">
                            <div class="chat__message">Ce e-book sera li√© √† vos coordonn√©es telles que votre num√©ro de t√©l√©phone et votre adresse email afin de vous permettre de le consulter √† tout moment.</div>
                        </div>
                        <div class="chat__message-wrapper" style="--index: 5">
                            <div class="chat__message flex-grow-1">
                                Pouvez-vous me donner votre <strong>nom</strong> et <strong>pr√©nom</strong> s'il vous pla√Æt ?
                                <form action="javascript:void()" class="form" data-toggle="form" data-option="department_contact_step">
                                    <div class="form-row">
                                        <div class="form-col">
                                            <label class="form-lable">T√©l√©phone*</label>
                                            <input type="number" class="form-control" name="telephone" placeholder=" " required>
                                            <div class="form-error">
                                                <small class="form-error__before">Votre e-mail et votre t√©l√©phone seront vos identifiants de t√©l√©chargement.</small>
                                                <small class="form-error__after">Champs requis</small>
                                            </div>
                                        </div>
                                        <div class="form-col">
                                            <label class="form-lable">E-mail*</label>
                                            <input type="email" class="form-control" name="email" placeholder=" " required>
                                            <div class="form-error">
                                                <small class="form-error__after">Champs requis</small>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="text-right">
                                        <button type="submit" class="form-btn">Recevoir mon e-book (3/3)</button>
                                    </div>
                                </form>
                            </div>
                        </div>
                    </div>`,
                department_contact_step : `
                    <div class="chat__card chat__card--client">
                        <div class="chat__message-wrapper" style="--index: 0">
                            <div class="chat__message">
                                <div><strong>T√©l√©phone: </strong><span data-input-value="telephone"></span></div>
                                <div><strong>E-mail: </strong><span data-input-value="email"></span></div>
                            </div>
                        </div>
                    </div>
                    <div class="chat__card chat__card--agent">
                        <div class="chat__message-wrapper" style="--index: 1">
                            <div class="chat__message">Calcul des aides en cours ... patientez s'il vous plait</div>
                        </div>
                        <div class="chat__message-wrapper" style="--index: 2">
                            <div class="chat__message">Calcul des aides en cours 0...</div>
                        </div>
                    </div>`,
            };

            $(document).on('change', '[data-toggle="message"]', function(){
                const currentKey = $(this).attr("data-option");
                const currentParentElement = $(this).closest(".chat__card");
                const lastOptionTemplateKey = Object.keys(allOptionTemplate).pop();
                
                $(this).closest(".chat__message-wrapper").remove();

                if (allOptionTemplate.hasOwnProperty.call(allOptionTemplate, currentKey)) {
                    const getCurrentOptionResult = allOptionTemplate[currentKey];
                    currentParentElement.after(getCurrentOptionResult);                    
                    if(lastOptionTemplateKey == currentKey){
                        setTimeout(function(){
                            window.location = 'https://novecology.fr/';
                        },3000)
                    }
                }

            });

            $(document).on('submit', '[data-toggle="form"]', function(){
                const currentKey = $(this).attr("data-option");
                const currentParentElement = $(this).closest(".chat__card");
                const lastOptionTemplateKey = Object.keys(allOptionTemplate).pop();
                const formDataObject = Object.fromEntries(new FormData($(this).get(0)).entries());

                $(this).closest(".chat__message-wrapper").remove();

                if (allOptionTemplate.hasOwnProperty.call(allOptionTemplate, currentKey)) {
                    const getCurrentOptionResult = allOptionTemplate[currentKey];
                    currentParentElement.after(getCurrentOptionResult);
                    for (const [key, value] of Object.entries(formDataObject)) {
                        $(`[data-input-value="${key}"]`).text(value);
                    }
                    if(lastOptionTemplateKey == currentKey){
                        setTimeout(function(){
                            window.location = 'https://novecology.fr/';
                        },3000)
                    }
                }
            });
        })
    </script>
</body>
</html>